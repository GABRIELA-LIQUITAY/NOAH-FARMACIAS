-- FUNCIONES
-- carlcular el total de ventas realizadas

 
DELIMITER //

CREATE FUNCTION total_diario(fecha_consulta DATE) RETURNS DECIMAL(14,4)
DETERMINISTIC
READS SQL DATA
BEGIN
  DECLARE total_diario DECIMAL(14,2);
  SELECT SUM(IMPORTE) INTO total_diario
  FROM FACTURACIONAB
  WHERE FHVENTA = fecha_consulta;
  RETURN total_diario;
END;
//
DELIMITER ;

SELECT total_diario ('2024/09/11'); 

-- FUNCION PARA VERIFICAR SI MEDIO DE PAGO ESTA ACTIVO 

DELIMITER //

-- DETERMINA SI EL CLIENTE HIZP UNA COMPRA
DELIMITER //

CREATE FUNCTION cliente_compro_mes(legajo INT, mes INT, anio INT) RETURNS BOOLEAN
DETERMINISTIC
READS SQL DATA
BEGIN
  DECLARE compro BOOLEAN;
  SELECT COUNT(*) INTO compro
  FROM FACTURACIONAB
  WHERE LEGAJO = legajo
    AND MONTH(FHVENTA) = mes
    AND YEAR(FHVENTA) = anio;
  RETURN compro > 0;
END;
//
DELIMITER ;
-- LLAMAR A LA FUNCION
SELECT cliente_compro_mes(329854446, 11, 2024) AS 'EL CLIENTE COMPRO ESTE MES ';
